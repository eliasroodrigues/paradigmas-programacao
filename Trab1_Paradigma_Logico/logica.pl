/* ==================================================
*  Paradigmas de Linguagem - Trabalho 1
*  Prolog
*
*  Aluno: Elias E. S. Rodrigues, 0015920
*  ================================================ */

% FATOS %
/* ===============================================================
*  ID  Data         Produto   Loja         Qtd  Tipo   ValU ValT
================================================================== */
compra([01,'01-10-2021','cimento','loja do ze', 10, 'saco', 28, 280]).
compra([02,'01-10-2021','cal','loja do ze', 8, 'saco', 24, 192]).
compra([03,'01-10-2021','piso','loja do ze', 55, 'saco', 4, 220]).
compra([04,'02-10-2021','cimento','loja da maria', 10, 'saco', 29, 290]).
compra([05,'02-10-2021','cimento','loja da maria', 20, 'saco', 25, 500]).
compra([06,'03-10-2021','porta','loja do ze', 2, 'saco', 50, 100]).
compra([07,'04-11-2021','piso','loja do joao', 70, 'saco', 3, 210]).
compra([08,'05-11-2021','piso','loja do joao', 34, 'saco', 3, 102]).
compra([09,'25-11-2021','tinta','loja da ana', 4, 'saco', 26, 104]).
compra([10,'24-12-2021','telha','loja do ana', 2, 'saco', 27, 54]).


% REGRAS %
/* ===============================================================
*  O produto X foi comprado?
================================================================== */
comprado(X) :- compra([_,_,X,_,_,_,_,_]).


/* ===============================================================
*  Qual foi a quantidade total comprada de um produto X?
================================================================== */
qtd_total(X,N,T) :- aggregate_all(count, comprado(X), N),compra([_,_,X,_,T,_,_,_]).


/* ===============================================================
*  Qual foi o valor total comprada de um produto X?
================================================================== */
valor_total(X,T) :- compra([_,_,X,_,_,_,_,T]).


/* ===============================================================
*  O que foi comprado na data X?
================================================================== */
comprado_em(X,P) :- compra([_,X,P,_,_,_,_,_]).


/* ===============================================================
*  Qual o total de compras em uma loja X?
================================================================== */
compra_loja_total(X,T) :- compra([_,_,_,X,_,_,_,T]).


/* ===============================================================
*  Qual o produto mais comprado?
================================================================== */
produto_mais_comprado(X,N,T) :- qtd_total(X,N,T).